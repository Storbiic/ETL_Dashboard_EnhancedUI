{% extends "base.html" %}

{% block content %}
<div class="space-y-12">
    <!-- Hero Section -->
    <div class="text-center space-y-6">
        <h1 class="text-6xl font-extrabold text-text-primary leading-tight">
            Excel ETL Integration
        </h1>
        <p class="text-xl font-medium text-text-secondary max-w-3xl mx-auto leading-relaxed">
            Upload, analyze, and transform Excel workbooks into Power BI-ready data with intelligent 
            automation and real-time insights
        </p>
    </div>

    
    <!-- Step 1: Upload -->
    <div id="upload-section" class="p-8 rounded-2xl shadow-glass transition-all duration-300 hover:shadow-glass-lg hover:-translate-y-1 fade-in" style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.3);">
        <div class="flex items-center justify-between mb-8">
            <h2 class="text-2xl font-bold text-text-primary">
                <i class="fas fa-upload mr-3 text-vista-blue"></i>
                Step 1: Upload Excel Workbook
            </h2>
            <div class="text-sm font-medium text-text-secondary flex items-center">
                <i class="fas fa-magic mr-2 text-vista-blue"></i>
                Auto-detection helps speed up your workflow
            </div>
        </div>

        <div class="border-2 border-dashed border-azure rounded-2xl p-16 text-center transition-all duration-300 upload-area hover:border-vista-blue hover:bg-azure/20 cursor-pointer">
            <input type="file" id="file-input" accept=".xlsx,.xls" class="hidden">
            <div id="upload-area">
                <i class="fas fa-cloud-upload-alt text-8xl text-vista-blue mb-8 transition-all duration-300"></i>
                <p class="text-2xl font-bold text-text-primary mb-4">Drop your Excel file here or click to browse</p>
                <p class="text-lg font-medium text-text-secondary">Supports .xlsx and .xls files (max 50MB)</p>
            </div>

            <!-- Enhanced Upload Progress -->
            <div id="upload-progress" class="hidden mt-8">
                <div class="flex items-center justify-center mb-6">
                    <div class="animate-spin rounded-full h-12 w-12 border-4 border-azure border-t-vista-blue mr-4"></div>
                    <span class="text-2xl font-bold text-text-primary">Uploading...</span>
                </div>
                <div class="w-full h-3 rounded-full" style="background: rgba(255,255,255,0.3);">
                    <div id="upload-progress-bar" class="h-3 rounded-full transition-all duration-300 relative overflow-hidden" style="width: 0%; background: linear-gradient(90deg, #7f9ec3 0%, #5d9bad 50%, #7f9ec3 100%);">
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"></div>
                    </div>
                </div>
                <div class="flex justify-between text-sm font-medium mt-4">
                    <span id="upload-status" class="text-text-secondary">Preparing upload...</span>
                    <span id="upload-percentage" class="text-vista-blue-dark font-bold">0%</span>
                </div>
            </div>

            <div id="processing-state" class="hidden mt-8">
                <div class="flex items-center justify-center mb-6">
                    <div class="w-12 h-12 rounded-full mr-4 animate-pulse" style="background: #10b981;"></div>
                    <span class="text-2xl font-bold text-green-700">Processing file...</span>
                </div>
                <p class="text-lg text-text-secondary">Analyzing Excel sheets and detecting data structure...</p>
            </div>
        </div>

        <!-- File Info Display -->
        <div id="file-info" class="hidden mt-8 p-6 rounded-xl" style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.2);">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center justify-center w-12 h-12 rounded-full" style="background: rgba(16, 185, 129, 0.2);">
                        <i class="fas fa-file-excel text-green-600 text-xl"></i>
                    </div>
                    <div>
                        <h3 id="file-name" class="text-lg font-bold text-green-700">filename.xlsx</h3>
                        <p id="file-size" class="text-sm text-green-600">File size</p>
                    </div>
                </div>
                <button id="remove-file" class="px-4 py-2 rounded-xl text-sm font-medium transition-all duration-300 text-red-600 hover:bg-red-50 hover:text-red-700">
                    <i class="fas fa-times mr-2"></i>
                    Remove
                </button>
            </div>
        </div>

        <!-- Sheet Selection -->
        <div id="sheet-selection" class="hidden mt-8 space-y-6">
            <div class="border-t border-gray-200 pt-8">
                <h3 class="text-xl font-bold text-text-primary mb-6">
                    <i class="fas fa-table mr-3 text-vista-blue"></i>
                    Select Sheets for Processing
                </h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- MasterBOM Sheet Selection -->
                    <div class="space-y-4">
                        <label class="block text-lg font-bold text-text-primary">
                            <i class="fas fa-list-alt mr-2 text-vista-blue"></i>
                            MasterBOM Sheet
                        </label>
                        <select id="master-sheet-select" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-vista-blue focus:border-transparent transition-all duration-300 text-lg">
                            <option value="">Select MasterBOM sheet...</option>
                        </select>
                        <p class="text-sm text-text-secondary">Choose the sheet containing part numbers and specifications</p>
                    </div>

                    <!-- Status Sheet Selection -->
                    <div class="space-y-4">
                        <label class="block text-lg font-bold text-text-primary">
                            <i class="fas fa-chart-line mr-2 text-vista-blue"></i>
                            Status Sheet
                        </label>
                        <select id="status-sheet-select" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-vista-blue focus:border-transparent transition-all duration-300 text-lg">
                            <option value="">Select Status sheet...</option>
                        </select>
                        <p class="text-sm text-text-secondary">Choose the sheet containing status and timeline data</p>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 flex justify-between items-center">
                <div class="text-sm font-medium text-text-secondary flex items-center">
                    <i class="fas fa-magic mr-2 text-vista-blue"></i>
                    Auto-detection helps speed up your workflow
                </div>
                <button id="preview-btn"
                        class="glass-btn"
                        disabled
                        onclick="previewSheets()">
                    <i class="fas fa-eye mr-2"></i>
                    Preview Selected Sheets
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}